<!-- #BeginTemplate "/Templates/manual-page.dwt" --><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
	<!-- #TemplateBeginEditable name="doctitle" -->
		<title>Unity - Troubleshooting on iPhone</title>
	<!-- #TemplateEndEditable -->
</head>
<link rel="StyleSheet"  href="../Images/docs.css" type="text/css" />
<body>
<table class="titlebar" cellpadding=0 cellspacing=0 border=0><tr>
	<td class="titleleft"><img src="../images/top/left.png"></td>
	<td><a href="../../Documentation.html"><img src="../images/top/logo.png"></a></td>
	<td class="titlemid">
		<table><tr>
			<td class="doctitle">Troubleshooting on iPhone</td>
			<td class="Manual" align="right"><a href="../Manual/index.html" title="Go to Unity manual"><img src="../images/spacer.gif" width="72" height="36" class="manual" border="0"></a></td>
			<td class="Manual" width="94"><a href="../Components/index.html" title="Go to Reference"><img src="../images/spacer.gif" width="94" height="36" class="reference" border="0"></a></td>
			<td class="Manual" width="82"><a href="../ScriptReference/index.html" title="Go to Scripting Reference"><img src="../images/spacer.gif" width="82" height="36" class="scripting" border="0"></a></td>
		</tr><tr>
			<td colspan="4">
				<table width="100%" class="docpath"><tr><td >
		<!-- #TemplateBeginEditable name="path" -->
					<a href="../Manual/index.html">Unity Manual</a> &gt; <a href="../Manual/iphone-GettingStarted.html">Getting Started with iPhone Development</a> &gt; <a href="../Manual/iphone-troubleshooting.html">Troubleshooting on iPhone</a>
		<!-- #TemplateEndEditable -->	
				</td>
				</td><td class="switchlink">
					<!--BeginSwitchLink--><!--EndSwitchLink-->
				</td></tr></table>
			</td>
		</tr></table>
	</td>
	<td class="titleright" width="9"><img src="../images/top/right.png"></td>
</tr></table>
<div class="manual">
	<div class="main">

		<!-- #TemplateBeginEditable name="navigation" -->
		<div class="nav">
		<div class="nav-prev">
			<a href='../Manual/iphone-unsupported.html'>
				<div class="nav-left"></div>
				<div class="nav-main">Previous</div>
				<div class="nav-right"></div>
			</a>
		</div>
	
		<div class="nav-next">
			<a href='../Manual/FAQ.html'>
				<div class="nav-left"></div>
				<div class="nav-main">Next</div>
				<div class="nav-right"></div>
			</a>
		</div>
	</div>
		<!-- #TemplateEndEditable -->	
		<!-- #TemplateBeginEditable name="title" -->
			<h1>Troubleshooting on iPhone</h1>
		<!-- #TemplateEndEditable -->	
		<!-- #TemplateBeginEditable name="body" -->
			
<p>There some known scenarios when your game works perfectly in the Unity iPhone Editor but doesn't work or doesn't even start on the actual device.
The problems often relate to code or content quality. This chapter describes the most common scenarios.
</p>
<div class='vspace'></div><h2>Game stops responding after some time. <span class='wikiword'>XCode</span> shows "interrupted" in the status bar.</h2>
<p>There could be several causes for this. You need to review the <span class='wikiword'>XCode</span> Debugger console for details. The <span class='wikiword'>XCode</span> Debugger console can be accessed from <span class='wikiword'>XCode</span> menu <span class='doc-prop'>Run-&gt;Console</span>.
</p>
<div class='vspace'></div><h3><span class='wikiword'>XCode</span> console shows "Program received signal:  “SIGBUS”.</h3>
<p>This message typically appears on iPhone OS 3.0 devices when your application receives a Null Reference Exception. Hit <span class='doc-prop'>Continue</span> <b>twice</b> on the <span class='wikiword'>XCode</span> debugger toolbar and exception processing will continue. Uncatched exceptions will be catched and printed by the engine.
</p>
<div class='vspace'></div><h3><span class='wikiword'>XCode</span> console shows "Unknown error occured in: " or "<span class='wikiword'>NullReferenceException</span> occured in:".</h3>
<p>This message typically appears on iPhone OS 2.x devices when your application receives a Null Reference Exception. Only the last stack frame is printed (if Null Reference exception happened in managed code). After such exception the application is suspended and can't be resumed. If you are developing for iPhone OS 2.x devices make sure that your production code does not throw Null Reference exceptions under any circumstances.
</p>
<div class='vspace'></div><h3><span class='wikiword'>XCode</span> console shows "WARNING -&gt; applicationDidReceiveMemoryWarning()" followed with immediate application crash.</h3>
<p>This warning message in many cases isn't fatal and only indicates that the iPhone OS is low on memory and has asked applications to free some memory. Typically, some background processes like Mail will free some memory and your application can continue to run. But, if your application continues to use memory or ask for more at some point the OS will start killing applications and your application can be killed. Apple does not document what memory usage is safe, but empirical observations show that applications using less than 25 MB of RAM do not have any memory usage problems, applications using 40 MB of RAM may have memory problems on some devices and may require device restart to run properly.
Primary metric that you always should rely on is how much RAM your application uses. Your application memory usage consists of three major parts:
</p><ul><li>application code (OS needs to load and keep in RAM your application code);
</li><li>native heap which is used by engine to store its state, your assets, etc. in RAM;
</li><li>managed heap is used by your Mono .NET runtime to keep C# or <span class='wikiword'>JavaScript</span> objects.
</li></ul><p>Your application memory usage can be tracked by two <span class='wikiword'>XCode</span> Instruments tools: <span class='doc-prop'>Activity Monitor</span> and <span class='doc-prop'>Object Allocations</span>. You can start one or the other from the <span class='wikiword'>XCode</span> Run menu: <span class='doc-prop'>Run-&gt;Start with Performance Tool-&gt;Activity Monitor</span> and <span class='doc-prop'>Run-&gt;Start with Performance Tool-&gt;Object Allocations</span>. The first tool shows all process statistics, including <span class='doc-prop'>Real memory</span>, which could be considered as total amount of RAM used by your application. 
</p>
<div class='vspace'></div><div><img class='figure' src='../Images/manual/iphone-troubleshooting-0.jpg' /> </div>
<p class='vspace'>The other tool displays all allocations made by your application and includes native heap + managed heap statistics (don't forget to check <span class='doc-prop'>Created and still living</span> box to get the current state of application). You should look at the <span class='doc-prop'>Net bytes</span> value.
</p>
<div class='vspace'></div><div><img class='figure' src='../Images/manual/iphone-troubleshooting-1.jpg' /></div>
<p class='vspace'>Some hints for how to keep memory usage low:
</p><ul><li>Reduce the application binary size by using the strongest iPhone stripping options (Advanced license feature), and avoid unnecessary dependencies to various .NET libraries. Check for details <a href="../Components/class-PlayerSettings.html">here</a> and <a href="../Manual/iphone-playerSizeOptimization.html">here</a>;
</li><li>Reduce your content size: use PVRTC compression for textures, use low poly models. Check for details <a href="../Manual/Reducing File size.html">here</a>;
</li><li>Don't allocate too much in your scripts. Track mono heap size and usage with <a href="../Manual/iphone-InternalProfiler.html">internal profiler</a>.
</li></ul><p class='vspace'>Querying the OS for the amount of free memory could look like a good idea to evaluate how well your application performs. However, this has very little relation to real life, because OS uses a lot of dynamic buffers and caches. You should always track memory consumption for your application and use it as main metric. That should be the only reliable method. Just asking how much free memory is left from the OS will lead you nowhere. Pay attention to how the graphs from the tools described above change over the time, especially after loading new levels.
</p>
<div class='vspace'></div><h2>Game runs fine when launched from <span class='wikiword'>XCode</span> and crashes on first level load when launched manually on the device.</h2>
<p>There could be several reasons for this. You need to inspect the device logs to get more details. Connect the device to your Mac, launch <span class='wikiword'>XCode</span>, go to <span class='wikiword'>XCode</span> menu <span class='doc-prop'>Window-&gt;Organizer</span>, select your device in Orginizer's left toolbar, click on "Console" tab and review the latest messages carefully. Additionally you may need to investigate crash reports. You can find how to obtain crash reports <a class='urllink' href='http://developer.apple.com/iphone/library/technotes/tn2008/tn2151.html' rel='nofollow'>here</a>. 
</p><h3><span class='wikiword'>XCode</span> Organizer console contains "killed by <span class='wikiword'>SpringBoard</span>".</h3>
<p>There is a not well documented time limit for an iPhone application to render its first frames and process input. If your application misses this time limit it gets killed by <span class='wikiword'>SpringBoard</span>. A typical case is an application with a large first scene. To avoid this problem it is recommended to create a small initial scene which just displays a splash screen, waits a frame or two with <span class='doc-keyword'>yield</span> and starts loading the real scene. A code sample for this could be:
</p><pre class='codelisting'> 
function Start () {
    yield;
    Application.LoadLevel("Test");
}
</pre>

		<!-- #TemplateEndEditable -->	

		<div class="nav">
		<div class="nav-prev">
			<a href='../Manual/iphone-unsupported.html'>
				<div class="nav-left"></div>
				<div class="nav-main">Previous</div>
				<div class="nav-right"></div>
			</a>
		</div>
	
		<div class="nav-next">
			<a href='../Manual/FAQ.html'>
				<div class="nav-left"></div>
				<div class="nav-main">Next</div>
				<div class="nav-right"></div>
			</a>
		</div>
	</div>
	</div>
</div>
</body></html>
<!-- #EndTemplate -->
